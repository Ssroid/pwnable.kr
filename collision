문제>
Daddy told me about cool MD5 hash collision today.
I wanna do something like that too!

풀이>
$ cat col.c
-----
#include <stdio.h>
#include <string.h>
unsigned long hashcode = 0x21DD09EC;
unsigned long check_password(const char* p){
        int* ip = (int*)p;
        int i;
        int res=0;
        for(i=0; i<5; i++){
                res += ip[i];
        }
        return res;
}

int main(int argc, char* argv[]){
        if(argc<2){
                printf("usage : %s [passcode]\n", argv[0]);
                return 0;
        }
        if(strlen(argv[1]) != 20){
                printf("passcode length should be 20 bytes\n");
                return 0;
        }

        if(hashcode == check_password( argv[1] )){
                system("/bin/cat flag");
                return 0;
        }
        else
                printf("wrong passcode.\n");
        return 0;
}
-----
메인 함수에서 입력값 1개를 받고 20바이트보다 커야한다. 
그리고 hashcod 의 값과 check_password 함수의 값가 동일 하다면 flag값을 알려준다.
c언어 에서 char는 1바이트의 크기로 int* ip= (int*)p; 로 char* p의 20바이트를 
int 로 20바이트를 만들므로 int는 하나당 4바이트이니 5개가 있는것이다.

나중에 수정할게




도움블로그>
